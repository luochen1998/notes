<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
</head>

<body>
    <script>
        const createCanvas = (width = 300, height = 300) => {
            const canvas = document.createElement("canvas");
            document.body.append(canvas);
            canvas.width = width;
            canvas.height = height;
            canvas.style.border = "1px solid";
            const ctx = canvas.getContext("2d");
            return ctx;
        };
        /**
         * 图像合成
         * 将前后图形合成一个图形
         * 使用ctx.globalCompositeOperation属性，设置合成机制
         * 需要在前后两个图形中间设置
         *     1.路径（形状）合成
         *          source-over:（'默认'）前后图形都展示，后面的图形覆盖在前面的图形上
         *          source-in:只展示后面的图形，只展示与前面图形重叠的部分
         *          source-out:只展示后面的图形，只展示与前面图形不重叠的部分
         *          source-atop:只展示前面的图形和后面的图形只展示与前面图形重叠的部分
         *          destination-(over,in,out,atop)和上面合成特点相同，但是前后图形交换
         *              以destination-over为例，前面的图形覆盖着后面的图形上
         *          copy 后面图形的覆盖前面的图形（前面的图形没了）
         *          xor 展示前后两个图形非重叠部分        
         *          
          */

        //前后图形都展示，后面的图形覆盖在前面的图形上
        (() => {
            const ctx = createCanvas()
            ctx.beginPath()
            ctx.fillStyle = '#f00'
            ctx.fillRect(100, 100, 100, 100)
            ctx.globalCompositeOperation = 'source-over'
            ctx.beginPath()
            ctx.fillStyle = '#00f'
            ctx.fillRect(150, 150, 100, 100)
        })();
        //只展示后面的图形，只展示与前面图形重叠的部分
        (() => {
            const ctx = createCanvas()
            ctx.beginPath()
            ctx.fillStyle = '#f00'
            ctx.fillRect(100, 100, 100, 100)
            ctx.globalCompositeOperation = 'source-in'
            ctx.beginPath()
            ctx.fillStyle = '#00f'
            ctx.fillRect(150, 150, 100, 100)
        })();
        // //只展示后面的图形，只展示与前面图形不重叠的部分
        (() => {
            const ctx = createCanvas()
            ctx.fillStyle = '#f00'
            ctx.fillRect(100, 100, 100, 100)
            ctx.globalCompositeOperation = 'source-out'
            ctx.beginPath()
            ctx.fillStyle = '#00f'
            ctx.fillRect(150, 150, 100, 100)
        })();
        // //只展示前面的图形和后面的图形只展示与前面图形重叠的部分
        (() => {
            const ctx = createCanvas()
            ctx.fillStyle = '#f00'
            ctx.fillRect(100, 100, 100, 100)
            ctx.globalCompositeOperation = 'source-atop'
            ctx.beginPath()
            ctx.fillStyle = '#00f' 
            ctx.fillRect(150, 150, 100, 100)
        })();


        //前后图形都展示，前面的图形覆盖在前面的图形上
        (() => {
            const ctx = createCanvas()
            ctx.beginPath()
            ctx.fillStyle = '#f00'
            ctx.fillRect(100, 100, 100, 100)
            ctx.globalCompositeOperation = 'destination-over'
            ctx.beginPath()
            ctx.fillStyle = '#00f'
            ctx.fillRect(150, 150, 100, 100)
        })();
        //只展示前面的图形，只展示与后面图形重叠的部分
        (() => {
            const ctx = createCanvas()
            ctx.beginPath()
            ctx.fillStyle = '#f00'
            ctx.fillRect(100, 100, 100, 100)
            ctx.globalCompositeOperation = 'destination-in'
            ctx.beginPath()
            ctx.fillStyle = '#00f'
            ctx.fillRect(150, 150, 100, 100)
        })();
        //只展示前面的图形，只展示与后面图形不重叠的部分
        (() => {
            const ctx = createCanvas()
            ctx.fillStyle = '#f00'
            ctx.fillRect(100, 100, 100, 100)
            ctx.globalCompositeOperation = 'destination-out'
            ctx.beginPath()
            ctx.fillStyle = '#00f'
            ctx.fillRect(150, 150, 100, 100)
        })();
        //只展示后面的图形和前面的图形只展示与后面图形重叠的部分
        (() => {
            const ctx = createCanvas()
            ctx.fillStyle = '#f00'
            ctx.fillRect(100, 100, 100, 100)
            ctx.globalCompositeOperation = 'destination-atop'
            ctx.beginPath()
            ctx.fillStyle = '#00f'
            ctx.fillRect(150, 150, 100, 100)
        })();
        //后面的图形覆盖前面图形，前面图形没了
        (() => {
            const ctx = createCanvas()
            ctx.fillStyle = '#f00'
            ctx.fillRect(100, 100, 100, 100)
            ctx.globalCompositeOperation = 'copy'
            ctx.beginPath()
            ctx.fillStyle = '#00f'
            ctx.fillRect(150, 150, 100, 100)
        })();
        //只展示前后图形非重叠的部分
        (() => {
            const ctx = createCanvas()
            ctx.fillStyle = '#f00'
            ctx.fillRect(100, 100, 100, 100)
            ctx.globalCompositeOperation = 'destination-atop'
            ctx.beginPath()
            ctx.fillStyle = '#00f'
            ctx.fillRect(150, 150, 100, 100)
        })();
    </script>
</body>

</html>